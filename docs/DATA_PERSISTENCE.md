# AIDG æ•°æ®æŒä¹…åŒ–è¯´æ˜

## æ¦‚è¿°

ä½¿ç”¨ `docker compose up -d` è¿è¡Œ AIDG ç³»ç»Ÿåï¼Œæ‰€æœ‰é¡¹ç›®å’Œä¼šè®®æ•°æ®éƒ½ä¼š**æŒä¹…åŒ–ä¿å­˜**åœ¨å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¸ä¼šå› ä¸ºå®¹å™¨åœæ­¢æˆ–åˆ é™¤è€Œä¸¢å¤±ã€‚

## æ•°æ®å­˜å‚¨ä½ç½®

### å®¿ä¸»æœºè·¯å¾„ï¼ˆå®é™…å­˜å‚¨ä½ç½®ï¼‰

æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `data/` æ–‡ä»¶å¤¹ä¸‹ï¼š

```
/Users/tshinjeii/Documents/code/python/AIDG/data/
â”œâ”€â”€ projects/          # é¡¹ç›®æ•°æ®
â”œâ”€â”€ meetings/          # ä¼šè®®æ•°æ®
â”œâ”€â”€ users/            # ç”¨æˆ·æ•°æ®
â””â”€â”€ audit_logs/       # å®¡è®¡æ—¥å¿—
```

### å®¹å™¨å†…è·¯å¾„

å®¹å™¨å†…å¯¹åº”çš„è·¯å¾„ä¸ºï¼š

```
/app/data/
â”œâ”€â”€ projects/          # é¡¹ç›®æ•°æ®
â”œâ”€â”€ meetings/          # ä¼šè®®æ•°æ®
â”œâ”€â”€ users/            # ç”¨æˆ·æ•°æ®
â””â”€â”€ audit_logs/       # å®¡è®¡æ—¥å¿—
```

## Volume æ˜ å°„é…ç½®

### docker-compose.yml é…ç½®

```yaml
volumes:
  # Mount data directories for persistence
  - ./data/projects:/app/data/projects
  - ./data/users:/app/data/users
  - ./data/meetings:/app/data/meetings
  - ./data/audit_logs:/app/data/audit_logs
```

**è¯´æ˜**ï¼š
- ä½¿ç”¨ Docker Volume å°†å®¿ä¸»æœºç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…
- æ•°æ®å®é™…å­˜å‚¨åœ¨å®¿ä¸»æœºï¼Œå®¹å™¨åªæ˜¯è¯»å†™å®¿ä¸»æœºæ–‡ä»¶
- å®¹å™¨åœæ­¢ã€åˆ é™¤ã€é‡å»ºéƒ½ä¸ä¼šå½±å“æ•°æ®

## å„ç›®å½•è¯¦ç»†è¯´æ˜

### 1. é¡¹ç›®æ•°æ® (projects/)

**è·¯å¾„**ï¼š`./data/projects/`

**å†…å®¹**ï¼š
```
data/projects/
â”œâ”€â”€ .svn/                           # SVN ç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ AI-Dev-Gov/                     # é¡¹ç›®æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ feature_list.json          # ç‰¹æ€§åˆ—è¡¨
â”‚   â”œâ”€â”€ architecture.md            # æ¶æ„è®¾è®¡
â”‚   â””â”€â”€ tasks/                     # ä»»åŠ¡æ•°æ®
â”œâ”€â”€ NIEP/                          # å¦ä¸€ä¸ªé¡¹ç›®
â”œâ”€â”€ NISG/                          # å¦ä¸€ä¸ªé¡¹ç›®
â”œâ”€â”€ server_projects.json           # é¡¹ç›®å…ƒæ•°æ®
â”œâ”€â”€ roles/                         # è§’è‰²å®šä¹‰
â””â”€â”€ user_roles/                    # ç”¨æˆ·è§’è‰²å…³è”
```

**æ•°æ®ç±»å‹**ï¼š
- é¡¹ç›®å…ƒæ•°æ®ï¼ˆJSONï¼‰
- ç‰¹æ€§åˆ—è¡¨ï¼ˆJSONï¼‰
- æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆMarkdownï¼‰
- ä»»åŠ¡éœ€æ±‚æ–‡æ¡£ï¼ˆMarkdownï¼‰
- ä»»åŠ¡è®¾è®¡æ–‡æ¡£ï¼ˆMarkdownï¼‰
- ä»»åŠ¡æµ‹è¯•æ–‡æ¡£ï¼ˆMarkdownï¼‰
- è§’è‰²æƒé™é…ç½®ï¼ˆJSONï¼‰

### 2. ä¼šè®®æ•°æ® (meetings/)

**è·¯å¾„**ï¼š`./data/meetings/`

**å†…å®¹**ï¼š
```
data/meetings/
â”œâ”€â”€ .svn/                              # SVN ç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ 0908_NIEPå†…éƒ¨è®¨è®º/                 # ä¼šè®®æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ audio.wav                     # éŸ³é¢‘æ–‡ä»¶
â”‚   â”œâ”€â”€ transcript.txt                # è½¬å½•æ–‡æœ¬
â”‚   â”œâ”€â”€ summary.md                    # ä¼šè®®æ€»ç»“
â”‚   â”œâ”€â”€ topic.md                      # è®¨è®ºè¯é¢˜
â”‚   â”œâ”€â”€ feature_list.json             # æå–çš„ç‰¹æ€§åˆ—è¡¨
â”‚   â””â”€â”€ architecture_design.md        # æ¶æ„è®¾è®¡
â”œâ”€â”€ 0912_AIè®¨è®º/
â”œâ”€â”€ 0915_äº§å“é¡¹ç›®ä¾‹ä¼š/
â””â”€â”€ server_tasks.json                  # ä¼šè®®ä»»åŠ¡ç´¢å¼•
```

**æ•°æ®ç±»å‹**ï¼š
- éŸ³é¢‘æ–‡ä»¶ï¼ˆWAV/MP3ï¼‰
- è½¬å½•æ–‡æœ¬ï¼ˆTXTï¼‰
- ä¼šè®®æ€»ç»“ï¼ˆMarkdownï¼‰
- è®¨è®ºè¯é¢˜ï¼ˆMarkdownï¼‰
- ç‰¹æ€§åˆ—è¡¨ï¼ˆJSONï¼‰
- æ¶æ„è®¾è®¡ï¼ˆMarkdownï¼‰

### 3. ç”¨æˆ·æ•°æ® (users/)

**è·¯å¾„**ï¼š`./data/users/`

**å†…å®¹**ï¼š
```
data/users/
â””â”€â”€ users.json                         # ç”¨æˆ·æ•°æ®åº“
```

**users.json ç»“æ„**ï¼š
```json
{
  "admin": {
    "username": "admin",
    "password_hash": "...",
    "scopes": [
      "user.manage",
      "project.doc.read",
      "project.doc.write",
      "meeting.read",
      "meeting.write",
      ...
    ],
    "created_at": "2025-10-08T12:00:00Z"
  },
  "houzhh": {
    "username": "houzhh",
    "password_hash": "...",
    "scopes": [
      "user.manage",
      "meeting.read",
      "meeting.write"
    ],
    "created_at": "2025-10-08T13:00:00Z"
  }
}
```

**æ•°æ®ç±»å‹**ï¼š
- ç”¨æˆ·å‡­æ®ï¼ˆç”¨æˆ·åã€å¯†ç å“ˆå¸Œï¼‰
- ç³»ç»Ÿçº§æƒé™ï¼ˆscopesï¼‰
- ç”¨æˆ·åˆ›å»ºæ—¶é—´

### 4. å®¡è®¡æ—¥å¿— (audit_logs/)

**è·¯å¾„**ï¼š`./data/audit_logs/`

**å†…å®¹**ï¼š
- ç”¨æˆ·æ“ä½œæ—¥å¿—
- API è®¿é—®è®°å½•
- æƒé™å˜æ›´è®°å½•
- ç³»ç»Ÿäº‹ä»¶æ—¥å¿—

## æ•°æ®æŒä¹…åŒ–æœºåˆ¶

### å·¥ä½œåŸç†

1. **Volume æŒ‚è½½**ï¼š
   - Docker Compose å¯åŠ¨æ—¶ï¼Œå°†å®¿ä¸»æœºçš„ `./data/` ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ `/app/data/` ç›®å½•
   - å®¹å™¨å†…çš„æ‰€æœ‰è¯»å†™æ“ä½œç›´æ¥ä½œç”¨äºå®¿ä¸»æœºæ–‡ä»¶

2. **å®¹å™¨æ— çŠ¶æ€**ï¼š
   - å®¹å™¨æœ¬èº«ä¸å­˜å‚¨ä»»ä½•ä¸šåŠ¡æ•°æ®
   - å®¹å™¨å¯ä»¥éšæ—¶åˆ é™¤å’Œé‡å»ºï¼Œä¸å½±å“æ•°æ®

3. **æ•°æ®éš”ç¦»**ï¼š
   - æ¯ä¸ªæ•°æ®ç±»å‹æœ‰ç‹¬ç«‹çš„ç›®å½•
   - æ”¯æŒç‹¬ç«‹å¤‡ä»½å’Œæ¢å¤

### æ•°æ®å®‰å…¨æ€§

âœ… **ä¼˜åŠ¿**ï¼š
- **æŒä¹…åŒ–**ï¼šå®¹å™¨åœæ­¢æˆ–åˆ é™¤åæ•°æ®ä¸ä¸¢å¤±
- **å¯å¤‡ä»½**ï¼šç›´æ¥å¤‡ä»½ `./data/` ç›®å½•å³å¯
- **å¯è¿ç§»**ï¼šå¤åˆ¶ `./data/` ç›®å½•åˆ°å…¶ä»–æœºå™¨å³å¯è¿ç§»
- **å¯ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡ SVN ç®¡ç†é¡¹ç›®å’Œä¼šè®®æ•°æ®

âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼š
- æ•°æ®å­˜å‚¨åœ¨å®¿ä¸»æœºï¼Œæ³¨æ„ç£ç›˜ç©ºé—´
- å®šæœŸå¤‡ä»½ `./data/` ç›®å½•åˆ°å…¶ä»–ä½ç½®
- `users.json` åŒ…å«å¯†ç å“ˆå¸Œï¼Œæ³¨æ„æƒé™ä¿æŠ¤

## æ•°æ®å¤‡ä»½ä¸æ¢å¤

### å¤‡ä»½æ•°æ®

**æ–¹æ³• 1ï¼šç›´æ¥å¤åˆ¶**
```bash
# å¤‡ä»½æ•´ä¸ª data ç›®å½•
cp -r ./data ./data_backup_$(date +%Y%m%d_%H%M%S)
```

**æ–¹æ³• 2ï¼šä½¿ç”¨ tar å‹ç¼©**
```bash
# å‹ç¼©å¤‡ä»½
tar -czf aidg_data_backup_$(date +%Y%m%d_%H%M%S).tar.gz ./data
```

**æ–¹æ³• 3ï¼šä½¿ç”¨ SVN**
```bash
# é¡¹ç›®å’Œä¼šè®®æ•°æ®å·²ç»ä½¿ç”¨ SVN ç‰ˆæœ¬æ§åˆ¶
cd data/projects && svn commit -m "Backup projects"
cd data/meetings && svn commit -m "Backup meetings"
```

### æ¢å¤æ•°æ®

**ä»å¤‡ä»½æ¢å¤**ï¼š
```bash
# åœæ­¢å®¹å™¨
docker compose down

# æ¢å¤æ•°æ®ï¼ˆæ–¹æ³•1ï¼šä»ç›®å½•ï¼‰
rm -rf ./data
cp -r ./data_backup_20250108_120000 ./data

# æ¢å¤æ•°æ®ï¼ˆæ–¹æ³•2ï¼šä»å‹ç¼©åŒ…ï¼‰
tar -xzf aidg_data_backup_20250108_120000.tar.gz

# å¯åŠ¨å®¹å™¨
docker compose up -d
```

## æ•°æ®è¿ç§»

### è¿ç§»åˆ°æ–°æœºå™¨

1. **å¯¼å‡ºæ•°æ®**ï¼š
   ```bash
   # åœ¨æ—§æœºå™¨ä¸Š
   cd /Users/tshinjeii/Documents/code/python/AIDG
   tar -czf aidg_data_export.tar.gz ./data
   ```

2. **ä¼ è¾“æ•°æ®**ï¼š
   ```bash
   # å¤åˆ¶åˆ°æ–°æœºå™¨
   scp aidg_data_export.tar.gz user@new-server:/path/to/AIDG/
   ```

3. **å¯¼å…¥æ•°æ®**ï¼š
   ```bash
   # åœ¨æ–°æœºå™¨ä¸Š
   cd /path/to/AIDG
   tar -xzf aidg_data_export.tar.gz
   docker compose up -d
   ```

## æŸ¥çœ‹æ•°æ®çŠ¶æ€

### æŸ¥çœ‹æ•°æ®ç›®å½•å¤§å°

```bash
# æŸ¥çœ‹å„ç›®å½•å¤§å°
du -sh ./data/*

# è¾“å‡ºç¤ºä¾‹ï¼š
# 4.0K    ./data/audit_logs
# 64M     ./data/meetings
# 12M     ./data/projects
# 4.0K    ./data/users
```

### æŸ¥çœ‹é¡¹ç›®åˆ—è¡¨

```bash
# æŸ¥çœ‹æ‰€æœ‰é¡¹ç›®
ls -la ./data/projects/

# æŸ¥çœ‹é¡¹ç›®å…ƒæ•°æ®
cat ./data/projects/server_projects.json
```

### æŸ¥çœ‹ä¼šè®®åˆ—è¡¨

```bash
# æŸ¥çœ‹æ‰€æœ‰ä¼šè®®
ls -la ./data/meetings/

# æŸ¥çœ‹ä¼šè®®ä»»åŠ¡ç´¢å¼•
cat ./data/meetings/server_tasks.json
```

### æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨

```bash
# æŸ¥çœ‹ç”¨æˆ·æ•°æ®
cat ./data/users/users.json
```

## ç¯å¢ƒå˜é‡é…ç½®

### docker-compose.yml ä¸­çš„ç›¸å…³é…ç½®

```yaml
environment:
  - PROJECTS_DIR=/app/data/projects      # é¡¹ç›®æ•°æ®ç›®å½•
  - USERS_DIR=/app/data/users           # ç”¨æˆ·æ•°æ®ç›®å½•
  - MEETINGS_DIR=/app/data/meetings     # ä¼šè®®æ•°æ®ç›®å½•
  - AUDIT_LOGS_DIR=/app/data/audit_logs # å®¡è®¡æ—¥å¿—ç›®å½•
```

è¿™äº›ç¯å¢ƒå˜é‡å‘Šè¯‰åº”ç”¨ç¨‹åºåœ¨å®¹å™¨å†…çš„å“ªé‡Œè¯»å†™æ•°æ®ã€‚

## ç‰ˆæœ¬æ§åˆ¶é›†æˆ

### SVN é›†æˆ

é¡¹ç›®å’Œä¼šè®®æ•°æ®ç›®å½•åŒ…å« `.svn/` æ–‡ä»¶å¤¹ï¼Œè¯´æ˜å·²ç»é›†æˆäº† SVN ç‰ˆæœ¬æ§åˆ¶ï¼š

```
data/projects/.svn/    # é¡¹ç›®æ•°æ®ç‰ˆæœ¬æ§åˆ¶
data/meetings/.svn/    # ä¼šè®®æ•°æ®ç‰ˆæœ¬æ§åˆ¶
```

**å¥½å¤„**ï¼š
- è‡ªåŠ¨è¿½è¸ªæ–‡ä»¶å˜æ›´
- æ”¯æŒå†å²ç‰ˆæœ¬å›æº¯
- å›¢é˜Ÿåä½œåŒæ­¥

## æ•°æ®ç›®å½•æƒé™

### Dockerfile ä¸­çš„æƒé™è®¾ç½®

```dockerfile
# åˆ›å»ºæ•°æ®ç›®å½•å¹¶è®¾ç½®æƒé™
RUN mkdir -p /app/data/projects \
             /app/data/users \
             /app/data/meetings \
             /app/data/audit_logs && \
    chown -R aidg:aidg /app

# åˆ‡æ¢åˆ°é root ç”¨æˆ·è¿è¡Œ
USER aidg
```

**è¯´æ˜**ï¼š
- å®¹å™¨å†…ä½¿ç”¨ `aidg` ç”¨æˆ·ï¼ˆUID 1000ï¼‰è¿è¡Œ
- å®¿ä¸»æœºä¸Šçš„æ–‡ä»¶æƒé™åº”è¯¥å…è®¸ UID 1000 è¯»å†™

## å¸¸è§é—®é¢˜

### Q1: å®¹å™¨åˆ é™¤åæ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ

**A**: ä¸ä¼šã€‚æ•°æ®å­˜å‚¨åœ¨å®¿ä¸»æœºçš„ `./data/` ç›®å½•ï¼Œå®¹å™¨åˆ é™¤ä¸å½±å“æ•°æ®ã€‚

### Q2: å¦‚ä½•æ¸…ç©ºæ‰€æœ‰æ•°æ®é‡æ–°å¼€å§‹ï¼Ÿ

**A**: 
```bash
# åœæ­¢å®¹å™¨
docker compose down

# å¤‡ä»½ç°æœ‰æ•°æ®ï¼ˆå¯é€‰ï¼‰
mv ./data ./data_backup

# åˆ›å»ºç©ºæ•°æ®ç›®å½•
mkdir -p ./data/{projects,users,meetings,audit_logs}

# é‡æ–°å¯åŠ¨ï¼ˆä¼šè‡ªåŠ¨åˆå§‹åŒ–ï¼‰
docker compose up -d
```

### Q3: æ•°æ®ç›®å½•å ç”¨ç©ºé—´è¿‡å¤§æ€ä¹ˆåŠï¼Ÿ

**A**:
1. æ¸…ç†æ—§çš„ä¼šè®®éŸ³é¢‘æ–‡ä»¶
2. åˆ é™¤ä¸éœ€è¦çš„é¡¹ç›®
3. å‹ç¼©å½’æ¡£å†å²æ•°æ®
4. è€ƒè™‘ä½¿ç”¨å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆå¦‚ MinIOã€S3ï¼‰

### Q4: å¦‚ä½•åœ¨å¤šä¸ªå®¹å™¨é—´å…±äº«æ•°æ®ï¼Ÿ

**A**: å½“å‰é…ç½®å·²ç»æ”¯æŒï¼Œå› ä¸ºæ•°æ®åœ¨å®¿ä¸»æœºä¸Šã€‚åªéœ€ç¡®ä¿ï¼š
- ä¸åŒå®¹å™¨ä½¿ç”¨ç›¸åŒçš„ volume æ˜ å°„
- å¤„ç†å¥½å¹¶å‘è®¿é—®çš„æ–‡ä»¶é”

### Q5: æ•°æ®å¯ä»¥ç”¨ Git ç®¡ç†å—ï¼Ÿ

**A**: 
- âœ… æ¨èï¼šç”¨æˆ·æ•°æ®ã€é…ç½®æ–‡ä»¶ï¼ˆå°æ–‡ä»¶ï¼‰
- âš ï¸ è°¨æ…ï¼šé¡¹ç›®æ–‡æ¡£ã€ä¼šè®®æ–‡æœ¬ï¼ˆä¸­ç­‰æ–‡ä»¶ï¼‰
- âŒ ä¸æ¨èï¼šéŸ³é¢‘æ–‡ä»¶ã€å¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶

å½“å‰å·²ä½¿ç”¨ SVNï¼Œæ›´é€‚åˆå¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

## æ€»ç»“

âœ… **å…³é”®è¦ç‚¹**ï¼š

1. **æ•°æ®å­˜å‚¨ä½ç½®**ï¼š`./data/` ç›®å½•ï¼ˆå®¿ä¸»æœºï¼‰
2. **æŒä¹…åŒ–æœºåˆ¶**ï¼šDocker Volume æŒ‚è½½
3. **æ•°æ®å®‰å…¨æ€§**ï¼šå®¹å™¨åˆ é™¤ä¸å½±å“æ•°æ®
4. **å¤‡ä»½æ–¹å¼**ï¼šç›´æ¥å¤åˆ¶ `./data/` ç›®å½•
5. **ç‰ˆæœ¬æ§åˆ¶**ï¼šé›†æˆ SVN ç®¡ç†é¡¹ç›®å’Œä¼šè®®æ•°æ®

**æ•°æ®è·¯å¾„æ˜ å°„**ï¼š
```
å®¿ä¸»æœº                                å®¹å™¨å†…
./data/projects/        â†’        /app/data/projects/
./data/meetings/        â†’        /app/data/meetings/
./data/users/           â†’        /app/data/users/
./data/audit_logs/      â†’        /app/data/audit_logs/
```

**å½“å‰çŠ¶æ€**ï¼ˆæˆªè‡³ 2025-10-08ï¼‰ï¼š
- é¡¹ç›®æ•°æ®ï¼šåŒ…å« AI-Dev-Govã€NIEPã€NISG ç­‰é¡¹ç›®
- ä¼šè®®æ•°æ®ï¼šåŒ…å« 24 ä¸ªä¼šè®®è®°å½•
- ç”¨æˆ·æ•°æ®ï¼šåŒ…å« admin å’Œ houzhh ä¸¤ä¸ªç”¨æˆ·
- æ•°æ®æ€»å¤§å°ï¼šçº¦ 80MBï¼ˆä¼°ç®—ï¼‰

æ‰€æœ‰æ•°æ®éƒ½å®‰å…¨åœ°æŒä¹…åŒ–åœ¨å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿä¸­ï¼ğŸ‰
